---
title: "Randomization Report (190224)"
author: "coop711"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# install.packages("pander", repos = "https://cran.rstudio.com")
# install.packages("xlsx", repos = "https://cran.rstudio.com")
library(xlsx)
library(pander)
library(knitr)
panderOptions('table.split.table', Inf)
panderOptions('table.alignment.rownames', 'left')
panderOptions('table.alignment.default', 'right')
```

<!--# Data Reading-->

```{r, data, echo = FALSE, results = 'hide'}
load("./red_and_black_intro_190224_data.RData")
str(class_roll)
```

# Randomization Effects

```{r, colleges, echo = FALSE}
#pander(class_roll)
#table("단과대학" = class_roll$college, "그룹" = class_roll$group)
```

## 학번 비교

### 전체 비교

```{r, echo = FALSE}
pander(table("그룹" = class_roll$group, substr(class_roll$id, 1, 4)))
```

### 19학번 기준

```{r, echo = FALSE}
ID_19 <- factor(ifelse(substr(class_roll$id, 1, 4) >= 2019, 
                       "younger_19", "older_19"), 
                levels = c("younger_19", "older_19"), 
                labels = c("19학번", "18학번 이전"))
pander(table("그룹" = class_roll$group, "19학번 기준" = ID_19))
```

## 학번 뒷자리 홀짝

```{r, odd or even, echo = FALSE}
odd_even <- as.numeric(class_roll$id) %% 2
odd_even_f <- factor(odd_even, levels = c(1, 0), labels = c("홀수", "짝수"))
pander(table("Group"= class_roll$group, "홀짝" = odd_even_f))
# kable(table("홀짝" = odd_even_f, "Group"= class_roll$group))
```

## 많이 나오는 성씨

```{r, name, echo = FALSE}
f_name <- substring(class_roll$name, first = 1, last = 1)
# f_name %in% c("김","이","박")
f_name_f <- factor(ifelse(f_name %in% c("김", "이", "박"), f_name, "기타"), 
                   levels = c("김", "이", "박", "기타"))
pander(table("Group" = class_roll$group, "Family Name" = f_name_f))
```

## 학년 

```{r, year, echo = FALSE}
year_f <- factor(class_roll$year, labels = c("1학년", "2학년", "3학년", "4학년"))
pander(table("Group" = class_roll$group, "학년" = year_f))
```

## e-mail 서비스

```{r, e_mail, echo = FALSE}
email_list <- strsplit(class_roll$email, "@", fixed = TRUE)
mail_com <- sapply(email_list, "[", 2)
mail_com_f <- factor(ifelse(mail_com == "naver.com", "네이버", "기타서비스"), 
                     levels = c("네이버", "기타서비스"))
pander(table("그룹" = class_roll$group, "e-mail" = mail_com_f))
```

## 학과

```{r, departments, echo = FALSE}
# pander(class_roll)
pander(table("그룹" = class_roll$group, "학과" = class_roll$dept))
```

## 전화번호의 분포

### 분포표

```{r, echo = FALSE}
cell_numbers <- sapply(substr(class_roll$cell_no, start = 10, stop = 13), 
                       as.numeric)
# cut_label <- c("1000~1999", "2000~2999", "3000~3999", "4000~4999", "5000~5999", "6000~6999",
#                "7000~7999", "8000~8999", "9000~9999")
cut_label <- paste(paste0(0:9, "000"), paste0(0:9, "999"), sep = "~")
kable(t(table(cut(cell_numbers, 
                  labels = cut_label, 
                  breaks = seq(0, 10000, by = 1000)))))
```

### 히스토그램

```{r, echo = FALSE}
hist(cell_numbers)
```

<!--

```{r, save, echo=FALSE, message=FALSE, results='hide'}
save.image("../R/red_and_black_intro_190224_data.RData")
```

-->